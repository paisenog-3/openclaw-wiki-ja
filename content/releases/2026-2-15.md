---
title: v2026.2.15
date: 2026-02-15
weight: 7
description: "2026年2月15日リリース"
---

## リリースサマリー

| 項目 | 内容 |
|------|------|
| **リリース日** | 2026年2月15日 |
| **主な新機能** | Discord Components v2対応、ネストされたサブエージェント、LLM入出力フック、チャンネル別ackリアクション設定 |
| **重要な修正** | SHA-1→SHA-256移行、サンドボックス脱出防止、XSS防止、CJK全文検索の修正 |
| **対象チャンネル** | Discord、Telegram、Slack、全チャンネル共通 |
| **破壊的変更** | なし |
| **推奨度** | ⭐⭐⭐⭐ セキュリティ修正多数のため全ユーザーに推奨 |

### アップデートすべき？

- **セキュリティを重視する人** → 強く推奨。サンドボックス脱出防止、XSS防止、トークン漏洩防止など多数のセキュリティ修正が含まれる
- **Discord使ってる人** → 推奨。Components v2によるボタン・セレクト・モーダル等のリッチUI対応
- **サブエージェントを活用してる人** → 推奨。ネストされたサブエージェント（サブのサブ）が利用可能に
- **日本語等の非ASCII言語で検索してる人** → 推奨。CJK全文検索のトークン化が修正された
- **上記に該当しない人** → セキュリティ修正の量を考慮すると、早めのアップデートを推奨

---

## 詳細

2026年2月15日にリリースされたv2026.2.15では、Discord Components v2によるリッチなインタラクション、ネストされたサブエージェント、多数のセキュリティ強化が行われました。

## 新機能

### Discord Components v2対応

Discordでボタン、セレクトメニュー、モーダル、ファイルブロック等のリッチなインタラクティブUIが利用可能になりました。CV2コンテナ、ボタンレイアウト、embeds パススルー、exec承認UXの改善も含まれています。

💡 **ポイント**: Discordネイティブのインタラクション機能をフル活用でき、ユーザーとの対話体験が大幅に向上します。

### ネストされたサブエージェント

サブエージェントが自身のサブエージェント（サブのサブ）を生成できるようになりました。`agents.defaults.subagents.maxSpawnDepth: 2` で深度を設定可能。エージェントあたりの子エージェント数制限（`maxChildrenPerAgent`、デフォルト5）、深度に応じたツールポリシー、適切なアナウンスチェーンルーティングが含まれます。

💡 **ポイント**: 複雑なタスクをさらに細かく分割・委譲でき、エージェントの自律的な問題解決能力が向上します。

### LLM入出力フック

プラグイン向けに`llm_input`と`llm_output`フックペイロードが公開され、プロンプト/入力コンテキストとモデル出力の利用状況を観測できるようになりました。

### チャンネル別ackリアクション設定

Slack、Discord、Telegramで、チャンネルごとにackリアクション絵文字をオーバーライドできるようになりました。アカウントレベル・チャンネルレベルでの設定に対応し、プラットフォーム固有の絵文字フォーマットもサポートします。

### Cronウェブフック配信制御

Cronジョブ完了時のウェブフック配信トグル（`notify`）と、専用のウェブフック認証トークン（`cron.webhookToken`）が追加されました。

### チャンネルプローブ型の整理

コアとエクステンション間でプローブ/トークン解決の基底型が統一され、チャンネル別のエラー型は維持されつつコードの重複が削減されました。

## バグ修正

### セキュリティ関連（重要）

**サンドボックスSHA-256移行**: 非推奨のSHA-1からSHA-256に移行し、サンドボックスキャッシュの同一性チェックが強化されました。

**サンドボックス脱出防止**: バインドマウント、ホストネットワーキング、unconfined seccomp/apparmorなどの危険なDocker設定をブロックし、設定インジェクションによるコンテナ脱出を防止します。

**Telegramトークン漏洩防止**: エラーメッセージやスタックトレースからTelegramボットトークンがレダクトされるようになりました。

**Control UI XSS防止**: アシスタント名/アバターを介したStored XSSを防止。インラインスクリプトインジェクションの除去、ブートストラップ設定のJSON配信、`script-src 'self'`の強制が行われました。

**スキルダウンロードのパス制限**: `download`インストーラの`targetDir`がスキル専用ディレクトリに制限され、任意のファイル書き込みを防止します。

**Web Fetchサイズ制限**: HTML解析前のレスポンスボディサイズに上限が設定され、巨大・深くネストされたページによるメモリ枯渇を防止します。

**ワークスペースパスのサニタイズ**: LLMプロンプトに埋め込まれるワークスペースパスからUnicode制御文字が除去され、悪意あるディレクトリ名による命令インジェクションを防止します。

**Gateway statusのレダクト**: 非管理者クライアントに対して、statusレスポンスからセンシティブなセッション/パス情報がレダクトされるようになりました。

**LINE Webhook起動時のバリデーション**: チャンネルトークンまたはチャンネルシークレットが欠けている場合、Webhook起動時にフェイルクローズするようになりました。

### メモリ・検索

**CJK全文検索の修正**: `buildFtsQuery`がUnicode対応になり、日本語・中国語・韓国語のクエリがベクトル検索のみにフォールバックせず、キーワードトークンとして正しく処理されるようになりました。

💡 **ポイント**: 日本語での記憶検索の精度が向上します。

### サブエージェント

- アナウンスの重複防止：子実行ベースの決定論的べき等キーにより、重複アナウンスリトライを防止しつつ、同一ミリ秒の異なるアナウンスは正しく区別
- モデルフォールバックの保持：サブエージェントがモデルオーバーライドを持つ場合でも、`agents.defaults.model.fallbacks`が維持されるように

### Telegram

- DM送信時に`message_thread_id`を省略し、フォーラムトピック処理を適切に維持（DM失敗の防止）
- 音声メッセージの`<media:audio>`プレースホルダーが音声トランスクリプトに正しく置換されるように
- メディア`getFile`呼び出しのリトライ（3回、バックオフ付き）を追加し、一時的なネットワークエラーでのメッセージ消失を防止
- ストリーミングプレビュー返信が重複メッセージを送信せず、インプレースで確定するように

### Discord

- `channelId`が欠けたペイロードでもチャンネルセッションの継続性を維持し、`sessionKey=unknown`問題を解消
- マルチエージェント環境でのスラッシュコマンド重複（`_2`サフィックス）を防止
- ロール許可リストのマッチングにraw role IDを使用するよう修正

### エージェント

- タイムゾーン対応の日付解決により、メモリファイル名の年号誤りを防止
- 埋め込み実行のタイムアウト時に明示的なエラー応答を返すように（サイレント応答消失の防止）
- グループチャットのコンテキスト（名前、参加者、返信ガイダンス）が毎ターン注入されるように修正
- ブラウザコントロールサービスが利用不可の場合、リトライではなく明示的な非リトライガイダンスを返すように
- コンテキストウィンドウの設定オーバーライドが正しく適用されるように（複数の修正）
- OpenAI Responses/Codex実行時に`store=true`を強制し、マルチターンの会話状態を保持

### Gateway・設定

- Control UIバイパスモード使用時のオペレータースコープ保持を修正
- センシティブキーのホワイトリスト照合が大文字小文字を区別しないように改善（`maxTokens`等の誤レダクト防止）
- `chat.send`でnullバイト拒否、安全でない制御文字の除去、Unicode NFC正規化を実施
- `send`がwebchatをターゲットにした場合、`chat.send`を使うよう案内するエラーを返すように
- 不正な`agent:`プレフィックス付きセッションキーを拒否し、クロスセッションルーティングを防止

### Cron

- `payload.kind`が省略された場合の`agentTurn`自動推論
- 各種修正と安定性向上

### TUI

- 検索可能セレクトのフィルタリングとハイライトレンダリングがANSI対応に
- Git Bashでの複数行メッセージ分割の防止
- URLやパスなどのトークンが折り返し時にスペースで分断されない修正
- その他レンダリング安定性の改善

### Auto-reply

- `NO_REPLY`プレースホルダーがTUI/Webに表示されないよう、送信成功時にツール送信テキストをミラーリング

### その他

- スキルのGoインストーラがroot/no-sudo環境で安全にフォールバック
- gitプリコミットフックの悪意あるファイル名によるオプションインジェクション防止
- サンドボックスの設定ハッシュで配列順序が保持されるように

---

詳細なchangelogは[公式CHANGELOGリポジトリ](https://github.com/openclaw/openclaw/blob/main/CHANGELOG.md#2026215)を参照してください。
